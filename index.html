<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>QuizoPolsce — Sprawdź wiedzę o Polsce</title>
<style>
:root{
  --bg1:#071025; --card:#0b1220; --text:#e6f7ff;
  --muted:#9fb6d6; --neon1:#00f0ff; --neon2:#ff3fc4;
  --good:#16d36a; --bad:#ff5c6c; --accent:#ffd27a; --radius:14px;
}
body{margin:0;font-family:Inter,sans-serif;background:linear-gradient(180deg,var(--bg1),#051028 80%);color:var(--text);display:flex;justify-content:center;padding:20px;}
.page{width:100%;max-width:920px}
.card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:22px;border-radius:var(--radius);box-shadow:0 10px 40px rgba(0,0,0,0.6);border:1px solid rgba(0,255,255,0.04);}
.top{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px;}
.title{font-weight:800;color:var(--neon1);letter-spacing:0.6px}
.answers{display:grid;grid-template-columns:1fr 1fr;gap:10px}
@media(max-width:700px){.answers{grid-template-columns:1fr}}
.btn{display:flex;align-items:center;justify-content:center;padding:12px;border-radius:12px;cursor:pointer;user-select:none;font-weight:800;color:white;min-height:52px;background:linear-gradient(90deg,var(--neon1),var(--neon2));border:1px solid rgba(255,255,255,0.02);}
.btn.good{background: linear-gradient(90deg,var(--good),#8df3b0);}
.btn.bad{background: linear-gradient(90deg,var(--bad),#ff8a94);}
#final{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.9);z-index:1200}
#final-card{background:#081322;padding:30px;border-radius:14px;text-align:center;max-width:580px;width:94%;}
canvas{position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:1100}
.ad-top,.ad-bottom,.ad-mid,.ad-final{background:#000;color:white;display:flex;align-items:center;justify-content:center;margin-bottom:12px;border-radius:12px;padding:8px;text-align:center;height:120px;}
</style>
</head>
<body>
<canvas id="fx"></canvas>
<div class="page">

  <div class="ad-top" id="adTop" data-zone="10241819">ładowanie reklamy...</div>

  <div class="card" id="quizCard">
    <div class="top">
      <div style="display:flex;flex-direction:column;gap:8px;">
        <div class="title">QuizoPolsce — Sprawdź wiedzę o Polsce</div>
        <input id="nick" placeholder="Nick" />
      </div>
    </div>

    <div id="question" class="question">Ładowanie...</div>
    <div id="answers" class="answers"></div>

    <div class="ad-mid" id="adMid" data-zone="10241826" style="display:none;">ładowanie reklamy...</div>

  </div>

  <div class="ad-bottom" id="adBottom" data-zone="10241836">ładowanie reklamy...</div>
</div>

<div id="final">
  <div id="final-card">
    <h1>Twój wynik</h1>
    <div id="final-text">0 pkt</div>
    <div class="ad-final" id="adFinal" data-zone="10241843" style="display:none;">ładowanie reklamy...</div>
    <div>
      <div class="btn" id="retryBtn">Zagraj ponownie</div>
      <div class="btn" id="shareBtn">Poleć quiz</div>
      <div class="btn" id="endBtn">Koniec</div>
    </div>
  </div>
</div>

<audio id="bg" loop src="sounds/background.mp3"></audio>
<audio id="snd-ding" src="sounds/ding.mp3"></audio>
<audio id="snd-buzzer" src="sounds/buzzer.mp3"></audio>
<audio id="snd-fanfare" src="sounds/fanfare.mp3"></audio>

<script>
const $ = id => document.getElementById(id);

function loadAdScriptOnce(url,id){ if(document.getElementById(id))return; const s=document.createElement('script'); s.src=url; s.async=true; s.id=id; document.head.appendChild(s); }

function injectAds(){
  document.querySelectorAll('[data-zone]').forEach(el=>{
    const zone = el.getAttribute('data-zone');
    const src = `https://groleegni.net/vignette.min.js?zone=${zone}`;
    if(el.style.display !== 'none'){ loadAdScriptOnce(src,'ad-'+zone); }
    else{
      const obs = new MutationObserver(()=>{ if(getComputedStyle(el).display!=='none'){ loadAdScriptOnce(src,'ad-'+zone); obs.disconnect(); } });
      obs.observe(el,{attributes:true,attributeFilter:['style']});
    }
  });
}
document.addEventListener('DOMContentLoaded',injectAds);

// --- QUIZ LOGIC (bez zmian od Twojej wersji) ---
let points=0,current=0;
const QUESTIONS = [
  { q: "Stolica Polski?", a: ["Warszawa","Kraków","Gdańsk","Wrocław"], correct:0 },
  { q: "Największy polski port?", a: ["Gdańsk","Gdynia","Szczecin","Świnoujście"], correct:0 },
  { q: "Największe miasto południa?", a: ["Kraków","Wrocław","Katowice","Łódź"], correct:0 },
  { q: "Polska w NATO od?", a:["1999","2004","1990","2001"], correct:0 },
  { q: "Skoczek z medalami?", a:["Adam Małysz","Kamil Stoch","Piotr Żyła","Andrzej Stękała"], correct:0 },
  { q: "Największe miasto mazowieckie?", a:["Warszawa","Radom","Płock","Siedlce"], correct:0 },
  { q: "Najważniejszy noblista chemii?", a:["Maria Skłodowska-Curie","Jan Czochralski","Michał Kalecki","Stefan Banach"], correct:0 },
  { q: "Najdłuższa rzeka?", a:["Wisła","Odra","Warta","Bug"], correct:0 },
  { q: "Najwyższy szczyt?", a:["Rysy","Śnieżka","Giewont","Babia Góra"], correct:0 },
  { q: "Rok odzyskania niepodległości?", a:["1918","1945","1914","1939"], correct:0 },
  { q: "Orzeł symbol?", a:["Godła","Flagi","Hymnu","Herbu"], correct:0 },
  { q: "Największe miasto Śląska?", a:["Katowice","Gliwice","Częstochowa","Bytom"], correct:0 },
  { q: "Hymn zaczyna się od?", a:["Jeszcze Polska nie zginęła","Mazurka Dąbrowskiego","Bogurodzicy","Roty"], correct:0 },
  { q: "Król „Lew Lechistanu”?", a:["Kazimierz Wielki","Bolesław Chrobry","Zygmunt Stary","Władysław Jagiełło"], correct:0 }
];

function getRandomSession(){ return QUESTIONS.map((q,i)=>({q,i})).sort(()=>Math.random()-0.5).slice(0,14).map(o=>o.i); }
let sessionQuestions = getRandomSession();

if('serviceWorker' in navigator){navigator.serviceWorker.register('/sw.js').catch(()=>{});}
document.body.addEventListener('click',()=>{if($('bg').paused)$('bg').play().catch(()=>{});},{once:true});

const questionEl=$('question'),answersEl=$('answers'),pointsEl=$('points'),progressEl=$('progress'),finalEl=$('final'),finalText=$('final-text');
const adTop=$('adTop'),adBottom=$('adBottom'),adMid=$('adMid'),adFinal=$('adFinal');

function showQuestion(){
  if(current===7){ adTop.style.display='none'; adBottom.style.display='none'; adMid.style.display='flex'; answersEl.innerHTML=''; setTimeout(()=>{adMid.style.display='none'; current++; showQuestion();},15000); return;}
  if(current>=sessionQuestions.length){ adTop.style.display='none'; adBottom.style.display='none'; adMid.style.display='none'; adFinal.style.display='flex'; answersEl.innerHTML=''; setTimeout(()=>{adFinal.style.display='none'; finishQuiz();},15000); return;}
  adTop.style.display='flex'; adBottom.style.display='flex'; adMid.style.display='none'; adFinal.style.display='none';
  const idx=sessionQuestions[current]; const q=QUESTIONS[idx]; questionEl.textContent=q.q; answersEl.innerHTML='';
  const shuffled=q.a.map((ans,i)=>({ans,i})).sort(()=>Math.random()-0.5);
  shuffled.forEach(obj=>{ const b=document.createElement('div'); b.className='btn'; b.textContent=obj.ans; b.onclick=()=>answer(obj.i, b, idx); answersEl.appendChild(b); });
}

function answer(idxAnswer, btn, questionIndex){
  const correct=QUESTIONS[questionIndex].correct;
  if(idxAnswer===correct){ btn.classList.add('good'); $('snd-ding').play().catch(()=>{}); points++; firework(); }
  else{ btn.classList.add('bad'); $('snd-buzzer').play().catch(()=>{}); }
  pointsEl.textContent=points; current++; setTimeout(showQuestion,400);
}

function finishQuiz(){ finalText.textContent=`${points} pkt`; finalEl.style.display='flex'; firework(); }

$('retryBtn').onclick=()=>{ points=0; current=0; sessionQuestions=getRandomSession(); finalEl.style.display='none'; showQuestion(); };
$('shareBtn').onclick=()=>{ const url=location.href; navigator.clipboard.writeText(url).then(()=>alert('Skopiowano link!')); };
$('endBtn').onclick=()=>{ finalEl.style.display='none'; };

function firework(){
  const canvas=$('fx'); const ctx=canvas.getContext('2d'); canvas.width=window.innerWidth; canvas.height=window.innerHeight;
  const particles=[]; const colors=['#ff3fc4','#00f0ff','#16d36a','#ffd27a','#ff5c6c','#ff8a00','#a020f0','#00ff90'];
  for(let b=0;b<3+Math.floor(Math.random()*3);b++){ const x=Math.random()*canvas.width,y=Math.random()*canvas.height*0.5; for(let i=0;i<40;i++){ particles.push({x,y,vx:(Math.random()-0.5)*10,vy:(Math.random()-0.5)*10,alpha:1,color:colors[Math.floor(Math.random()*colors.length)],size:2+Math.random()*2}); } }
  (function animate(){ ctx.fillStyle='rgba(0,0,0,0.1)'; ctx.fillRect(0,0,canvas.width,canvas.height); for(let i=particles.length-1;i>=0;i--){ const p=particles[i]; ctx.fillStyle=p.color; ctx.globalAlpha=p.alpha; ctx.beginPath(); ctx.arc(p.x,p.y,p.size,0,2*Math.PI); ctx.fill(); p.x+=p.vx; p.y+=p.vy; p.vy+=0.1; p.alpha-=0.02; if(p.alpha<=0) particles.splice(i,1);} if(particles.length>0) requestAnimationFrame(animate); else ctx.clearRect(0,0,canvas.width,canvas.height); })();
}

showQuestion();
</script>
</body>
</html>
