<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>QuizoPolsce ‚Äî Sprawd≈∫ wiedzƒô o Polsce</title>
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#051028">

<style>
  body {
    margin:0; padding:0;
    background:#050a18;
    color:white;
    font-family:Arial, sans-serif;
    user-select:none;
    text-align:center;
  }
  .btn {
    padding:14px;
    background:#111a30;
    border:2px solid #39f;
    margin:8px 0;
    border-radius:12px;
    cursor:pointer;
    font-size:18px;
    transition:0.2s;
  }
  .btn:hover { transform:scale(1.03); }
  .good { background:#0a0; }
  .bad { background:#a00; }
  #final { display:none; position:fixed; inset:0; 
    background:rgba(0,0,0,0.9); justify-content:center; align-items:center; flex-direction:column; }
  #fx { position:fixed; inset:0; pointer-events:none; }
  .adBox { width:100%; height:120px; display:none; justify-content:center; align-items:center; background:#0003; margin:10px 0; border:1px solid #333; }
</style>

<script>
function $(id){ return document.getElementById(id); }
</script>

<!-- üî•üî• TW√ìJ POPADS ‚Äî WSTAWIONY PRAWID≈ÅOWO üî•üî• -->
<script type="text/javascript" data-cfasync="false">
(function(){
var e=window,q="d31a1dee2b6abd0ee20b164c660efc53",
b=[["siteId",511+755*496-654+4883867],["minBid",0],["popundersPerIP","0"],
["delayBetween",0],["default",false],["defaultPerDay",0],["topmostLayer","auto"]],
c=["d3d3LmNkbjRhZHMuY29tL2tuQXYvZGVtb2ppZnkubWluLmpz",
"ZDNnNW92Zm5nanc5YncuY2xvdWRmcm9udC5uZXQvYmRxL04vcWNvb2tpZXMubWluLmNzcw=="],
i=-1,r,j,z=function(){clearTimeout(j);i++;
if(c[i]&&!(1791102328000<(new Date).getTime()&&1<i)){
r=e.document.createElement("script");
r.type="text/javascript";r.async=!0;
var l=e.document.getElementsByTagName("script")[0];
r.src="https://"+atob(c[i]);r.crossOrigin="anonymous";
r.onerror=z;
r.onload=function(){clearTimeout(j);e[q.slice(0,16)+q.slice(0,16)]||z()};
j=setTimeout(z,5E3);
l.parentNode.insertBefore(r,l)}};
if(!e[q]){try{Object.freeze(e[q]=b)}catch(e){}z()}
})();
</script>
<!-- üî• KONIEC KODU POPADS -->

</head>

<body>

<h2 id="progress">≈Åadowanie‚Ä¶</h2>
<div id="points">0</div>

<div id="adTop" class="adBox">Miejsce na reklamƒô</div>

<h1 id="question"></h1>
<div id="answers"></div>

<div id="adBottom" class="adBox">Miejsce na reklamƒô</div>
<div id="adMid" class="adBox">Reklama ‚Äî poczekaj‚Ä¶</div>
<div id="adFinal" class="adBox">Reklama przed wynikiem‚Ä¶</div>

<div id="final">
  <h1 id="finalText"></h1>
  <button id="retryBtn" class="btn">Zagraj ponownie</button>
  <button id="shareBtn" class="btn">Udostƒôpnij</button>
  <button id="endBtn" class="btn">Zako≈Ñcz</button>
</div>

<canvas id="fx"></canvas>

<audio id="snd-ding" src="snd/ding.mp3"></audio>
<audio id="snd-buzzer" src="snd/bad.mp3"></audio>
<audio id="bg" src="snd/bg.mp3" loop></audio>

<script>
/* ---------------------- PYTANIA ------------------------ */
const QUESTIONS=[
  { q:"Stolica Polski?", a:["Warszawa","Krak√≥w","Gda≈Ñsk","Wroc≈Çaw"], correct:0 },
  { q:"Najwiƒôkszy polski port morski?", a:["Gda≈Ñsk","Gdynia","Szczecin","≈öwinouj≈õcie"], correct:0 },
  { q:"Najwiƒôksze miasto na po≈Çudniu Polski?", a:["Krak√≥w","Wroc≈Çaw","Katowice","≈Å√≥d≈∫"], correct:0 },
  { q:"Polska jest cz≈Çonkiem NATO od?", a:["1999","2004","1990","2001"], correct:0 },
  { q:"Polski skoczek narciarski z medalami?", a:["Adam Ma≈Çysz","Kamil Stoch","Piotr ≈ªy≈Ça","Andrzej Stƒôka≈Ça"], correct:0 },
  { q:"Najwiƒôksze miasto Mazowsza?", a:["Warszawa","Radom","P≈Çock","Siedlce"], correct:0 },
  { q:"Polski noblista w chemii?", a:["Maria Sk≈Çodowska-Curie","Jan Czochralski","Micha≈Ç Kalecki","Stefan Banach"], correct:0 },
  { q:"Najd≈Çu≈ºsza rzeka w Polsce?", a:["Wis≈Ça","Odra","Warta","Bug"], correct:0 },
  { q:"Najwy≈ºszy szczyt w Polsce?", a:["Rysy","≈önie≈ºka","Giewont","Babia G√≥ra"], correct:0 },
  { q:"Rok odzyskania niepodleg≈Ço≈õci?", a:["1918","1945","1914","1939"], correct:0 },
  { q:"Polski orze≈Ç jest symbolem?", a:["God≈Ça","Flagi","Hymnu","Herbu miasta"], correct:0 },
  { q:"Najwiƒôksze miasto ≈ölƒÖska?", a:["Katowice","Gliwice","Czƒôstochowa","Bytom"], correct:0 },
  { q:"Polski hymn zaczyna siƒô od?", a:["Jeszcze Polska nie zginƒô≈Ça","Mazurka DƒÖbrowskiego","Bogurodzicy","Roty"], correct:0 },
  { q:"Kr√≥l zwany 'Lwem Lechistanu'?", a:["Kazimierz Wielki","Boles≈Çaw Chrobry","Zygmunt Stary","W≈Çadys≈Çaw Jagie≈Ç≈Ço"], correct:0 }
];

let points=0, current=0;

function getRandomSession(){
  return QUESTIONS.map((q,i)=>({q,i}))
    .sort(()=>Math.random()-0.5)
    .slice(0,14)
    .map(o=>o.i);
}
let sessionQuestions=getRandomSession();

if('serviceWorker' in navigator){
  navigator.serviceWorker.register('/sw.js').catch(()=>{});
}

document.body.addEventListener('click',()=>{
  if(bg.paused) bg.play().catch(()=>{});
},{once:true});

/* ---------------------- QUIZ ------------------------ */
function showQuestion(){
  if(current===7){
    adTop.style.display='none';
    adBottom.style.display='none';
    adMid.style.display='flex';
    questionEl.textContent="OglƒÖdaj reklamƒô, aby kontynuowaƒá";
    answersEl.innerHTML="";
    setTimeout(()=>{ adMid.style.display='none'; current++; showQuestion(); },15000);
    return;
  }

  if(current>=sessionQuestions.length){
    adTop.style.display='none';
    adBottom.style.display='none';
    adMid.style.display='none';
    adFinal.style.display='flex';
    questionEl.textContent="OglƒÖdaj reklamƒô, aby zobaczyƒá wynik";
    answersEl.innerHTML="";
    setTimeout(()=>{ adFinal.style.display='none'; finishQuiz(); },15000);
    return;
  }

  adTop.style.display='flex';
  adBottom.style.display='flex';

  const idx=sessionQuestions[current];
  const q=QUESTIONS[idx];
  questionEl.textContent=q.q;
  answersEl.innerHTML='';

  const shuffled=q.a.map((ans,i)=>({ans,i})).sort(()=>Math.random()-0.5);
  shuffled.forEach(obj=>{
    const b=document.createElement('div');
    b.className='btn';
    b.textContent=obj.ans;
    b.onclick=()=>answer(obj.i,b,idx);
    answersEl.appendChild(b);
  });

  progressEl.textContent=`Pytanie ${current+1}/${sessionQuestions.length}`;
}

function answer(choice,btn,index){
  const correct=QUESTIONS[index].correct;
  if(choice===correct){
    btn.classList.add('good');
    $('snd-ding').play().catch(()=>{});
    setTimeout(fireworkAnswer,400);
    points++;
  } else {
    btn.classList.add('bad');
    $('snd-buzzer').play().catch(()=>{});
  }
  pointsEl.textContent=points;
  current++;
  setTimeout(showQuestion,400);
}

function finishQuiz(){
  finalText.textContent=`${points} pkt`;
  final.style.display='flex';
  setTimeout(fireworkFinal,600);
}

retryBtn.onclick=()=>{
  points=0; current=0;
  pointsEl.textContent='0';
  sessionQuestions=getRandomSession();
  final.style.display='none';
  showQuestion();
};

shareBtn.onclick=()=>{
  const url=location.href;
  if(navigator.share){
    navigator.share({title:"QuizoPolsce", text:"Zagraj w quiz!", url});
  } else {
    navigator.clipboard.writeText(url);
    alert("Skopiowano link: " + url);
  }
};

endBtn.onclick=()=>{ final.style.display='none'; };

/* ------------------ Fajerwerki -------------------- */
let fireworkRunning=false;
function firework(){
  if(fireworkRunning) return;
  fireworkRunning=true;

  const canvas=$('fx'), ctx=canvas.getContext('2d');
  canvas.width=innerWidth;
  canvas.height=innerHeight;

  const particles=[];
  const colors=['#ff3fc4','#00f0ff','#16d36a','#ffd27a','#ff5c6c','#ff8a00','#a020f0','#00ff90'];
  const bursts=3+Math.floor(Math.random()*3);

  for(let b=0;b<bursts;b++){
    const x=Math.random()*canvas.width;
    const y=Math.random()*canvas.height*0.5;
    for(let i=0;i<40;i++){
      particles.push({
        x, y,
        vx:(Math.random()-0.5)*10,
        vy:(Math.random()-0.5)*10,
        alpha:1,
        color:colors[Math.random()*colors.length|0],
        size:2+Math.random()*2
      });
    }
  }

  function anim(){
    ctx.fillStyle='rgba(0,0,0,0.1)';
    ctx.fillRect(0,0,canvas.width,canvas.height);

    for(let i=particles.length-1;i>=0;i--){
      const p=particles[i];
      ctx.fillStyle=p.color;
      ctx.globalAlpha=p.alpha;
      ctx.beginPath();
      ctx.arc(p.x,p.y,p.size,0,2*Math.PI);
      ctx.fill();

      p.x+=p.vx;
      p.y+=p.vy;
      p.vy+=0.1;
      p.alpha-=0.02;
      if(p.alpha<=0) particles.splice(i,1);
    }

    if(particles.length>0) requestAnimationFrame(anim);
    else { ctx.clearRect(0,0,canvas.width,canvas.height); fireworkRunning=false; }
  }
  anim();
}

function fireworkAnswer(){ firework(); }
function fireworkFinal(){ firework(); }

/* ------------------ Start -------------------- */
showQuestion();
</script>

</body>
</html>
